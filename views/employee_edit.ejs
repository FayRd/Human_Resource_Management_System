<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Edit</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="/style.css">
</head>
<body>
  <main>
    <!-- Navbar -->
    <%-include ('partials/navbar.ejs')%>
    <!-- Breadcrumb -->
      <div>
        <nav aria-label="breadcrumb">
          <ol class="px-4 breadcrumb c-pri-bg rounded-bottom">
            <li class="breadcrumb-item"><a class="white-txt" href="/">Home</a></li>
            <li class="breadcrumb-item"><a class="white-txt" href="/Employee">Employees</a></li>
            <li class="breadcrumb-item"><a class="white-txt" href="/Employee/<%=employee[0].emId%>"><%=`${employee[0].firstName} ${employee[0].lastName}`%></a></li>
            <li class="breadcrumb-item white-txt" aria-current="page">Edit</li>
          </ol>
        </nav>
      </div>
      <form action="/Employee/<%=employee[0].emId%>/Edit" method="POST">
    <section>
      <!-- Main -->
        <div class="container-fluid px-4 my-1">
          <h2 class="mb-3"><svg class="svg-icon" viewBox="0 0 20 20">
            <path d="M15.573,11.624c0.568-0.478,0.947-1.219,0.947-2.019c0-1.37-1.108-2.569-2.371-2.569s-2.371,1.2-2.371,2.569c0,0.8,0.379,1.542,0.946,2.019c-0.253,0.089-0.496,0.2-0.728,0.332c-0.743-0.898-1.745-1.573-2.891-1.911c0.877-0.61,1.486-1.666,1.486-2.812c0-1.79-1.479-3.359-3.162-3.359S4.269,5.443,4.269,7.233c0,1.146,0.608,2.202,1.486,2.812c-2.454,0.725-4.252,2.998-4.252,5.685c0,0.218,0.178,0.396,0.395,0.396h16.203c0.218,0,0.396-0.178,0.396-0.396C18.497,13.831,17.273,12.216,15.573,11.624 M12.568,9.605c0-0.822,0.689-1.779,1.581-1.779s1.58,0.957,1.58,1.779s-0.688,1.779-1.58,1.779S12.568,10.427,12.568,9.605 M5.06,7.233c0-1.213,1.014-2.569,2.371-2.569c1.358,0,2.371,1.355,2.371,2.569S8.789,9.802,7.431,9.802C6.073,9.802,5.06,8.447,5.06,7.233 M2.309,15.335c0.202-2.649,2.423-4.742,5.122-4.742s4.921,2.093,5.122,4.742H2.309z M13.346,15.335c-0.067-0.997-0.382-1.928-0.882-2.732c0.502-0.271,1.075-0.429,1.686-0.429c1.828,0,3.338,1.385,3.535,3.161H13.346z"></path>
          </svg>Employee Details</h2>
          <!-- Text Details -->
          <div class="row mb-4 p-3 mx-auto border shadow-sm">
            <div class="col-sm-6 mb-3 mb-sm-0">
              <div class="mb-3">
                <label for="em-id-e" class="form-label">Employee ID</label>
                <input type="number" aria-label="em-id-e" id="em-id-e" class="form-control" value="<%=employee[0].emId%>" disabled>
              </div>
              <div class="mb-3">
                <label for="first-name-e" class="form-label">Name</label>
                <div class="input-group">
                  <input type="text" aria-label="First name" id="first-name-e" class="form-control" placeholder="First name" value="<%=employee[0].firstName%>" name="firstName" required>
                  <input type="text" aria-label="Last name" id="last-name-e" class="form-control" placeholder="Last name" value="<%=employee[0].lastName%>" name="lastName" required>
                </div>
              </div>
              <div class="mb-3">
                <label for="p-email-e" class="form-label">Personal E-mail Address</label>
                <input type="email" class="form-control" id="p-email-e" placeholder="name@example.com" value="<%=employee[0].pEmail%>" name="pEmail" required>
              </div>
              <div class="mb-3">
                <label for="b-email-e" class="form-label">Business E-mail Address</label>
                <input type="email" class="form-control" id="b-email-e" placeholder="name@example.com" value="<%=employee[0].bEmail%>" name="bEmail" required>
              </div>
              <div class="mb-3">
                <label for="p-mobile-e" class="form-label">Personal Mobile</label>
                <div class="input-group">
                  <input type="tel" id="p-mobile-e" class="form-control" placeholder="Mobile" value="<%=employee[0].pMobile%>" name="pMobile" required>
                </div>
              </div>
              <div class="mb-3">
                <label for="b-mobile-e" class="form-label">Business Mobile</label>
                <div class="input-group">
                  <input type="tel" id="b-mobile-e" class="form-control" placeholder="Mobile" value="<%=employee[0].bMobile%>" name="bMobile" required>
                </div>
              </div>
            </div>
            <div class="col-sm-6 mb-3 mb-sm-0">
              <div class="mb-3">
                <label for="postal-code-e" class="form-label">Postal Code</label>
                <input type="text" class="form-control" id="postal-code-e" placeholder="740100" value="<%=employee[0].postal%>" name="postal" required>
              </div>
              <div class="mb-3">
                <label for="address-e" class="form-label">Address</label>
                <input type="text" class="form-control" id="address-e" placeholder="Woodlands St 13 Blk 123 #01-123" value="<%=employee[0].address%>" name="address" required>
              </div>
              <div class="mb-3">
                <label for="dpt-name-e" class="form-label">Department</label>
                <select class="form-select" aria-label="dpt-name-e" id="dpt-name-e" name="dpt" required>
                  <% for (let i=0;i<departments.length;i++) { %>
                    <option value="<%=departments[i].id%>" <% if (employee[0].DID === departments[i].id) { %> selected <% } %>><%=departments[i].name%></option>
                  <% } %>
                </select>
              </div>
              <div class="mb-3">
                <label for="leaves-available-e" class="form-label">Leaves Available</label>
                <input type="number" class="form-control" id="leaves-available-e" placeholder="No. of Leaves" value="<%=employee[0].leaves%>" name="leaves" required>
              </div>
              <div class="mb-3">
                <label for="dissmiss-em-e" class="form-label">Set Leaving Date</label><br>
                <% if (employee[0].dateLeft === null) { %>
                  <input type="date" class="form-control" id="dismiss-em-e" placeholder="DD/MM/YYYY" value="" name="dismissDisplay">
                <% } else {%>
                  <input type="date" class="form-control" id="dismiss-em-e" placeholder="DD/MM/YYYY" value="<%=employee[0].dateLeft.toLocaleDateString('en-CA')%>" name="dismissDisplay">
                <% } %>
              </div>
            </div>
          </div>
          <!-- Note -->
          <div class="row mb-4 p-3 mx-auto border shadow-sm">
            <div class="mb-3">
              <label for="note-e" class="form-label">Note</label>
              <textarea class="form-control" id="note-e" rows="3" name="note"><%=employee[0].note%></textarea>
            </div>
          </div>
        </div>  
    </section>
    <!-- Divider -->
    <div class="border"></div>
    <!-- Enrollment -->
    <section>
      <div class="container-fluid p-4">
        <h3 class="mb-2"><svg class="svg-icon" viewBox="0 0 20 20">
          <path d="M8.627,7.885C8.499,8.388,7.873,8.101,8.13,8.177L4.12,7.143c-0.218-0.057-0.351-0.28-0.293-0.498c0.057-0.218,0.279-0.351,0.497-0.294l4.011,1.037C8.552,7.444,8.685,7.667,8.627,7.885 M8.334,10.123L4.323,9.086C4.105,9.031,3.883,9.162,3.826,9.38C3.769,9.598,3.901,9.82,4.12,9.877l4.01,1.037c-0.262-0.062,0.373,0.192,0.497-0.294C8.685,10.401,8.552,10.18,8.334,10.123 M7.131,12.507L4.323,11.78c-0.218-0.057-0.44,0.076-0.497,0.295c-0.057,0.218,0.075,0.439,0.293,0.495l2.809,0.726c-0.265-0.062,0.37,0.193,0.495-0.293C7.48,12.784,7.35,12.562,7.131,12.507M18.159,3.677v10.701c0,0.186-0.126,0.348-0.306,0.393l-7.755,1.948c-0.07,0.016-0.134,0.016-0.204,0l-7.748-1.948c-0.179-0.045-0.306-0.207-0.306-0.393V3.677c0-0.267,0.249-0.461,0.509-0.396l7.646,1.921l7.654-1.921C17.91,3.216,18.159,3.41,18.159,3.677 M9.589,5.939L2.656,4.203v9.857l6.933,1.737V5.939z M17.344,4.203l-6.939,1.736v9.859l6.939-1.737V4.203z M16.168,6.645c-0.058-0.218-0.279-0.351-0.498-0.294l-4.011,1.037c-0.218,0.057-0.351,0.28-0.293,0.498c0.128,0.503,0.755,0.216,0.498,0.292l4.009-1.034C16.092,7.085,16.225,6.863,16.168,6.645 M16.168,9.38c-0.058-0.218-0.279-0.349-0.498-0.294l-4.011,1.036c-0.218,0.057-0.351,0.279-0.293,0.498c0.124,0.486,0.759,0.232,0.498,0.294l4.009-1.037C16.092,9.82,16.225,9.598,16.168,9.38 M14.963,12.385c-0.055-0.219-0.276-0.35-0.495-0.294l-2.809,0.726c-0.218,0.056-0.351,0.279-0.293,0.496c0.127,0.506,0.755,0.218,0.498,0.293l2.807-0.723C14.89,12.825,15.021,12.603,14.963,12.385"></path>
        </svg>Programmes Involved</h3>
        <table class="table mb-5">
            <tr>
              <th>Name</th><th>Enrollment Date</th><th>Status</th><th></th>
            </tr>
            <% if (employee[0].PN !== null) { %>
              <% for (let i=0; i<employee.length; i++) {%>
                <tr>
                    <td><% if (employee[i].PN === null) { %> [DELETED PROGRAMME] <% } else { %><a class="link-primary link-underline-opacity-50-hover link-underline-opacity-0" href="/ProgrammeCategory/<%=employee[i].PC%>/<%=employee[i].PID%>"><%=employee[i].PN%></a><% } %></td><td><%=employee[i].enrollDate.toLocaleDateString('en-GB', { day: '2-digit', month: '2-digit', year: 'numeric' })%></td><td><select class="form-select" id="status-e1" name="status<%=employee[i].PID%>">
                      <% for (let j=0;j<statuses.length;j++) { %>
                        <option value=<%=statuses[j].id%> <% if (statuses[j].name === employee[i].SN) { %> selected <% } %>><%=statuses[j].name%></option>
                      <% } %>
                    </select></td>
                    <td><a href="/Employee/<%=employee[i].emId%>/<%=employee[i].PID%>/Delete" type="button" class="btn btn-danger"><svg class="svg-icon programme-d" viewBox="0 0 20 20"><path d="M17.114,3.923h-4.589V2.427c0-0.252-0.207-0.459-0.46-0.459H7.935c-0.252,0-0.459,0.207-0.459,0.459v1.496h-4.59c-0.252,0-0.459,0.205-0.459,0.459c0,0.252,0.207,0.459,0.459,0.459h1.51v12.732c0,0.252,0.207,0.459,0.459,0.459h10.29c0.254,0,0.459-0.207,0.459-0.459V4.841h1.511c0.252,0,0.459-0.207,0.459-0.459C17.573,4.127,17.366,3.923,17.114,3.923M8.394,2.886h3.214v0.918H8.394V2.886z M14.686,17.114H5.314V4.841h9.372V17.114z M12.525,7.306v7.344c0,0.252-0.207,0.459-0.46,0.459s-0.458-0.207-0.458-0.459V7.306c0-0.254,0.205-0.459,0.458-0.459S12.525,7.051,12.525,7.306M8.394,7.306v7.344c0,0.252-0.207,0.459-0.459,0.459s-0.459-0.207-0.459-0.459V7.306c0-0.254,0.207-0.459,0.459-0.459S8.394,7.051,8.394,7.306"></path></svg></button></td>
                </tr>
                <% } %>
            <% } %>
            <tr>
                <td colspan="3"><select class="form-select border-primary text-primary" id="enroll-new-p-e" name="programmeId" placeholder="Enroll New Programme">
                  <option selected value="none">Enroll New Programme</option>
                  <% for (let i=0; i<programmes.length; i++) { %>
                    <option value="<%=programmes[i].id%>"><%=programmes[i].name%></option>
                  <% } %>
                </select></td><td></td>
            </tr>
        </table>
        <button type="submit" class="btn btn-success">Save</button>
      </form>
      <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#delete-cfm-modal-employee-e">Delete</button>
      </div>
    </section>
  </form>
    <!-- Modal -->
    <div class="modal fade" id="delete-cfm-modal-employee-e" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content border text-bg-dark">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="delete-cfm-modal-employee-e-label">Confirmation</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <form>
            <div class="modal-body">
              This action will <span class="text-danger">remove</span> this employee from the database <strong>permanently!</strong>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
              <a href="/Employee/<%=employee[0].emId%>/Delete" class="btn btn-danger">Delete Forever</a>
            </div>
          </form>
        </div>
      </div>
    </div>
  </main>
    <footer>
        <%-include ('partials/footer.ejs')%>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>